{% extends 'base.html' %}
{% load staticfiles %}

{% block css %}


{% endblock %}



{% block content %}
<div class="row">
    <div class="col-md-12 col-sm-12" id="plateSelector">
    </div>

</div>


<div class="row">
	<div class="col-md-12 col-sm-12" id="tableview">
	</div>
</div>

{% endblock %}


{% block script %}
<script src='{% static "tablevis.js" %}'></script>
<script src = '{% static "plate_selector.js"%}'></script>
<script>
$(function() {

	var url = '{% url "data-list" %}';

	var MyEventHandler = new Object();

	var wrangleData = function(_data) {

		return _data;

	}



	d3.json(url,function(d){

		var thisData = wrangleData(d);
		
		var tableview =new TableVis(d3.select("#tableview"),thisData,MyEventHandler);	
		
		var plateselector = new PlateSelector(d3.select("#plateSelector"),thisData,MyEventHandler);

        $(MyEventHandler).bind("hit", function(event, plate_well){
            
            d3.json(url+plate_well+'/mark',function(d){
            });
            //update these visualization

        });

        $(MyEventHandler).bind("welltype", function(event, plate_well, welltype){
            console.log(welltype)
            d3.json(url+plate_well+'/set'+welltype,function(d){
            });
            //update these visualization

        });

        $(MyEventHandler).bind("plate", function(event, p){
            $.get(url,
                {'plate':p},
                function(d){
                    
                    plateselector.onPlateChange(p);
                    tableview.onPlateChange(wrangleData(d));
                });
        });
	});

});


</script>

{% endblock %}

